# Hank / Loneoceans Lume X1

The Lume X1 is a boost driver offered in some Hank (Noctigon / Emisar) flashlights and uses the Anduril2 UI by ToyKeeper. This driver provides highly efficient constant-current power regulation with no PWM, and features Ultra Dynamic Range (UDR) for extremely low moon/firefly modes. Rev B of the driver uses the new AVR32DD20 MCU, providing more space for extra features and future firmware updates.

The Lume X1 is offered in different hardware configurations with a designed power capability of up to 40 Watts. These configs include 6V, 9V, and 12V options, matched appropriately to different emitter combinations. When paired with certain configs (e.g. 3S3P E17A), the driver power level may be limited (~9V 3A) to avoid exceeding the maximum thermal capabilities of the emitters. 

Due to the high power handling capability of this driver, the driver should only be used with unprotected high-drain 21700 Lithium-ion cells only. This includes the Molicel P42, P45, P50, Samsung 40T, 50S, or Vapcell 50T. 

## Firmware

All HW configurations use the same firmware, and their config can be identified based on markings made directly on the silkscreen of the PCB, typically via a marking indicating 6V, 9V, or 12V. Driver HW revision versions are indicated by a letter followed by a MM/YY date code. 

- Rev B0224 - `anduril.hank-lume-x1.hex` (HWID 0281) (Final HWID TBD)

Firmware updates can be made via the standardized 3-pin UPDI flashing interface, with pin-outs printed on the PCB silkscreen.

## Hardware Specifics

The Lume X1 driver is part of the Lume-series of flashlight drivers by Loneoceans, first introduced in 2020. The Lume-series utilizes the concept of multiple power paths with different sense resistors to achieve a very high brightness dynamic range. These drivers feature reverse polarity protection, ESD protection, and adopt the open-sourced UI Anduril which handles thermal management and low-voltage protection.

The Lume X1 driver utilizes a highly-efficient synchronous boost topology together with a current-feedback loop to regulate output to the emitters. This allows an efficiency over 90% for most of the output range and over 95% at peak efficiency. 

The desired current is set using a reference voltage generated by the internal DAC of the MCU. The AVR32DD20 MCU provides two practical internal voltage references, effectively allowing for 2046 different DAC output levels with an effective resolution ~2497 levels. Combined with three power paths of the Lume X1, the driver allows very precise control over brightness, limited only by the 150 step ramp of Anduril. The hardware has been carefully tuned to provide good performance across the entire dynamic range with minimal artifacts. 

The lowest moonlight (or firefly) level of this driver can be vanishingly low (depending on emitter choice). At the lowest level, the emitters may appear to be off, but they are in fact very much still illuminated (this can be validated with a long exposure photograph!) These lower levels may not be practical since the Auxiliary button lights will be significantly brighter than the main emitter. Depending on config, the recommended default floor levels of the driver are ~11 and ~7 out of 150 for Simple and Advanced UI respectively (depending on ramp table used). 

Depending on the output voltage configuration, the designed maximum turbo output currents are 6.0A (for 6V configs), 4.0A (for 9v configs), and 3.0A (for 12V configs). Ceiling levels default to about ~12W maximum in Simple UI, and ~18W maximum in Advanced UI. 

Note that the hardware has been carefully calibrated to achieve this specification with a maximum DAC-level of 856/1023 at 2.5Vref. It is not recommended to exceed this value if you are generating your own ramp table.

For more information, please visit [Loneoceans Labs](http://www.loneoceans.com/labs/).